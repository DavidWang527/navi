#!/usr/bin/env bash
set -euo pipefail

export NAVI_HOME="${NAVI_HOME:-"${HOME}/.navi"}"

navi::clone_if_necessary() {
   [ -f "${NAVI_HOME}/scripts/dot" ] && return
   git clone "https://github.com/denisidoro/navi.git" "$NAVI_HOME"
}

_binary() {
   "${NAVI_HOME}/scripts/dot" rust binary "$@"
}

navi::clone_if_necessary

case "${FORCE_METHOD:-none}" in
   build) _binary install ;;
   download) _binary download ;;
   *) _binary download || _binary install ;;
esac
